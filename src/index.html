<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Map Notes - AngularJS 1.x</title>
  <meta name="description" content="Map Notes powered by AngularJS 1.x & AngularFire">
  <meta name="author" content="SitePoint">
  <meta name="viewport" content="initial-scale=1.0">
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link rel="stylesheet" href="css/styles.css?v=1.0">
  <style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
  }
  #map {
    height: 100%;
  }
</style>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <!-- Firebase -->
  <script src="https://cdn.firebase.com/js/client/2.4.0/firebase.js"></script>

  <!-- AngularFire -->
  <script src="https://cdn.firebase.com/libs/angularfire/1.2.0/angularfire.min.js"></script>

</head>

<body ng-app="myApp" ng-controller="MainController">

    <div class="header">
      <div class="container">
        <h1>{{ title }}</h1>
        <form ng-submit="addMessage()">
			<input type="text" ng-model="message">
			<input type="submit" value="Add Message">
		</form>
		<p>{{ message }}<p>
      </div>
    </div>

    <div class="container">
        <table>
        	<tr ng-repeat="msg in messages">
	        	<td>{{ msg.note }}</td>
	        	<td>{{ msg.time }}</td>
	        	<td>{{ msg.pos }}</td>
        		<td><button ng-click="messages.$remove(msg)">x</button></td>
        	</tr>
        </table>
    </div>

    <div class="footer">
      <div class="container">
        <h2>Available for iPhone and Android.</h2>
        <img src="https://s3.amazonaws.com/codecademy-content/projects/shutterbugg/app-store.png" width="120px" />
        <img src="https://s3.amazonaws.com/codecademy-content/projects/shutterbugg/google-play.png" width="110px" />
      </div>
    </div>

	<div id="map"></div>
	<script>
	  var map;
	  var pos;

	  function initMap() {
	    map = new google.maps.Map(document.getElementById('map'), {
	      center: {lat: 37.785, lng: -122.416},
	      zoom: 17
	    });
	  }

		function success(position) {
		  	pos = {
		  		lat: position.coords.latitude,
		  		lng: position.coords.longitude
		  	}
		  	map.setCenter(pos);
		}

		function error() {
			pos = false;
    		console.log("Unable to retrieve your location, you will not be allowed to post messages");
    	};

		navigator.geolocation.getCurrentPosition(success, error);

	</script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwRQ9zcwdAK6V25ZqT38j6PbkaVr2xCWE&callback=initMap"
    async defer></script>
  <script src="js/app.js"></script>
  <script src="js/controllers/MainController.js"></script>
</body>
</html>